/*
 *  Sharrre.com - Make your sharing widget!
 *  Version: beta 1.3.3 
 *  Author: Julien Hany
 *  License: MIT http://en.wikipedia.org/wiki/MIT_License or GPLv2 http://en.wikipedia.org/wiki/GNU_General_Public_License
 */

(function(a,b,c,d){function l(b,c){this.element=b;this.options=a.extend(true,{},g,c);this.options.share=c.share;this._defaults=g;this._name=f;this.init()}var f="sharrre",g={className:"sharrre",share:{googlePlus:false,facebook:false,twitter:false,digg:false,delicious:false,stumbleupon:false,linkedin:false,pinterest:false},shareTotal:0,template:"",title:"",url:c.location.href,text:c.title,urlCurl:"sharrre.php",count:{},total:0,shorterTotal:true,enableHover:true,enableCounter:true,enableTracking:false,hover:function(){},hide:function(){},click:function(){},render:function(){},buttons:{googlePlus:{url:"",urlCount:false,size:"medium",lang:"en-US",annotation:""},facebook:{url:"",urlCount:false,action:"like",layout:"button_count",width:"",send:"false",faces:"false",colorscheme:"",font:"",lang:"en_US"},twitter:{url:"",urlCount:false,count:"horizontal",hashtags:"",via:"",related:"",lang:"en"},digg:{url:"",urlCount:false,type:"DiggCompact"},delicious:{url:"",urlCount:false,size:"medium"},stumbleupon:{url:"",urlCount:false,layout:"1"},linkedin:{url:"",urlCount:false,counter:""},pinterest:{url:"",media:"",description:"",layout:"horizontal"}}},h={googlePlus:"",facebook:"http://graph.facebook.com/?id={url}&callback=?",twitter:"http://cdn.api.twitter.com/1/urls/count.json?url={url}&callback=?",digg:"http://services.digg.com/2.0/story.getInfo?links={url}&type=javascript&callback=?",delicious:"http://feeds.delicious.com/v2/json/urlinfo/data?url={url}&callback=?",stumbleupon:"",linkedin:"http://www.linkedin.com/countserv/count/share?format=jsonp&url={url}&callback=?",pinterest:""},i={googlePlus:function(d){var e=d.options.buttons.googlePlus;a(d.element).find(".buttons").append('<div class="button googleplus"><div class="g-plusone" data-size="'+e.size+'" data-href="'+(e.url!==""?e.url:d.options.url)+'" data-annotation="'+e.annotation+'"></div></div>');b.___gcfg={lang:d.options.buttons.googlePlus.lang};var f=0;if(typeof gapi==="undefined"&&f==0){f=1;(function(){var a=c.createElement("script");a.type="text/javascript";a.async=true;a.src="//apis.google.com/js/plusone.js";var b=c.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})()}else{gapi.plusone.go()}},facebook:function(b){var d=b.options.buttons.facebook;a(b.element).find(".buttons").append('<div class="button facebook"><div id="fb-root"></div><div class="fb-like" data-href="'+(d.url!==""?d.url:b.options.url)+'" data-send="'+d.send+'" data-layout="'+d.layout+'" data-width="'+d.width+'" data-show-faces="'+d.faces+'" data-action="'+d.action+'" data-colorscheme="'+d.colorscheme+'" data-font="'+d.font+'" data-via="'+d.via+'"></div></div>');var e=0;if(typeof FB==="undefined"&&e==0){e=1;(function(a,b,c){var e,f=a.getElementsByTagName(b)[0];if(a.getElementById(c)){return}e=a.createElement(b);e.id=c;e.src="//connect.facebook.net/"+d.lang+"/all.js#xfbml=1";f.parentNode.insertBefore(e,f)})(c,"script","facebook-jssdk")}else{FB.XFBML.parse()}},twitter:function(b){var d=b.options.buttons.twitter;a(b.element).find(".buttons").append('<div class="button twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-url="'+(d.url!==""?d.url:b.options.url)+'" data-count="'+d.count+'" data-text="'+b.options.text+'" data-via="'+d.via+'" data-hashtags="'+d.hashtags+'" data-related="'+d.related+'" data-lang="'+d.lang+'">Tweet</a></div>');var e=0;if(typeof twttr==="undefined"&&e==0){e=1;(function(){var a=c.createElement("script");a.type="text/javascript";a.async=true;a.src="//platform.twitter.com/widgets.js";var b=c.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})()}else{a.ajax({url:"//platform.twitter.com/widgets.js",dataType:"script",cache:true})}},digg:function(b){var d=b.options.buttons.digg;a(b.element).find(".buttons").append('<div class="button digg"><a class="DiggThisButton '+d.type+'" rel="nofollow external" href="http://digg.com/submit?url='+encodeURIComponent(d.url!==""?d.url:b.options.url)+'"></a></div>');var e=0;if(typeof __DBW==="undefined"&&e==0){e=1;(function(){var a=c.createElement("SCRIPT"),b=c.getElementsByTagName("SCRIPT")[0];a.type="text/javascript";a.async=true;a.src="//widgets.digg.com/buttons.js";b.parentNode.insertBefore(a,b)})()}},delicious:function(b){if(b.options.buttons.delicious.size=="tall"){var c="width:50px;",d="height:35px;width:50px;font-size:15px;line-height:35px;",e="height:18px;line-height:18px;margin-top:3px;"}else{var c="width:93px;",d="float:right;padding:0 3px;height:20px;width:26px;line-height:20px;",e="float:left;height:20px;line-height:20px;"}var f=b.shorterTotal(b.options.count.delicious);if(typeof f==="undefined"){f=0}a(b.element).find(".buttons").append('<div class="button delicious"><div style="'+c+'font:12px Arial,Helvetica,sans-serif;cursor:pointer;color:#666666;display:inline-block;float:none;height:20px;line-height:normal;margin:0;padding:0;text-indent:0;vertical-align:baseline;">'+'<div style="'+d+'background-color:#fff;margin-bottom:5px;overflow:hidden;text-align:center;border:1px solid #ccc;border-radius:3px;">'+f+"</div>"+'<div style="'+e+'display:block;padding:0;text-align:center;text-decoration:none;width:50px;background-color:#7EACEE;border:1px solid #40679C;border-radius:3px;color:#fff;">'+'<img src="http://www.delicious.com/static/img/delicious.small.gif" height="10" width="10" alt="Delicious" /> Add</div></div></div>');a(b.element).find(".delicious").on("click",function(){b.openPopup("delicious")})},stumbleupon:function(d){var e=d.options.buttons.stumbleupon;a(d.element).find(".buttons").append('<div class="button stumbleupon"><su:badge layout="'+e.layout+'" location="'+(e.url!==""?e.url:d.options.url)+'"></su:badge></div>');var f=0;if(typeof STMBLPN==="undefined"&&f==0){f=1;(function(){var a=c.createElement("script");a.type="text/javascript";a.async=true;a.src="//platform.stumbleupon.com/1/widgets.js";var b=c.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();s=b.setTimeout(function(){if(typeof STMBLPN!=="undefined"){STMBLPN.processWidgets();clearInterval(s)}},500)}else{STMBLPN.processWidgets()}},linkedin:function(d){var e=d.options.buttons.linkedin;a(d.element).find(".buttons").append('<div class="button linkedin"><script type="in/share" data-url="'+(e.url!==""?e.url:d.options.url)+'" data-counter="'+e.counter+'"></script></div>');var f=0;if(typeof b.IN==="undefined"&&f==0){f=1;(function(){var a=c.createElement("script");a.type="text/javascript";a.async=true;a.src="//platform.linkedin.com/in.js";var b=c.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})()}else{b.IN.init()}},pinterest:function(b){var d=b.options.buttons.pinterest;a(b.element).find(".buttons").append('<div class="button pinterest"><a href="http://pinterest.com/pin/create/button/?url='+(d.url!==""?d.url:b.options.url)+"&media="+d.media+"&description="+d.description+'" class="pin-it-button" count-layout="'+d.layout+'">Pin It</a></div>');(function(){var a=c.createElement("script");a.type="text/javascript";a.async=true;a.src="//assets.pinterest.com/js/pinit.js";var b=c.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})()}},j={googlePlus:function(){},facebook:function(){fb=b.setInterval(function(){if(typeof FB!=="undefined"){FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])});FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])});FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])});clearInterval(fb)}},1e3)},twitter:function(){tw=b.setInterval(function(){if(typeof twttr!=="undefined"){twttr.events.bind("tweet",function(a){if(a){_gaq.push(["_trackSocial","twitter","tweet"])}});clearInterval(tw)}},1e3)},digg:function(){},delicious:function(){},stumbleupon:function(){},linkedin:function(){function a(){_gaq.push(["_trackSocial","linkedin","share"])}},pinterest:function(){}},k={googlePlus:function(a){b.open("https://plus.google.com/share?hl="+a.buttons.googlePlus.lang+"&url="+encodeURIComponent(a.buttons.googlePlus.url!==""?a.buttons.googlePlus.url:a.url),"","toolbar=0, status=0, width=900, height=500")},facebook:function(a){b.open("http://www.facebook.com/sharer.php?u="+encodeURIComponent(a.buttons.facebook.url!==""?a.buttons.facebook.url:a.url)+"&t="+a.text+"","","toolbar=0, status=0, width=900, height=500")},twitter:function(a){b.open("https://twitter.com/intent/tweet?text="+encodeURIComponent(a.text)+"&url="+encodeURIComponent(a.buttons.twitter.url!==""?a.buttons.twitter.url:a.url)+(a.buttons.twitter.via!==""?"&via="+a.buttons.twitter.via:""),"","toolbar=0, status=0, width=650, height=360")},digg:function(a){b.open("http://digg.com/tools/diggthis/submit?url="+encodeURIComponent(a.buttons.digg.url!==""?a.buttons.digg.url:a.url)+"&title="+a.text+"&related=true&style=true","","toolbar=0, status=0, width=650, height=360")},delicious:function(a){b.open("http://www.delicious.com/save?v=5&noui&jump=close&url="+encodeURIComponent(a.buttons.delicious.url!==""?a.buttons.delicious.url:a.url)+"&title="+a.text,"delicious","toolbar=no,width=550,height=550")},stumbleupon:function(a){b.open("http://www.stumbleupon.com/badge/?url="+encodeURIComponent(a.buttons.delicious.url!==""?a.buttons.delicious.url:a.url),"stumbleupon","toolbar=no,width=550,height=550")},linkedin:function(a){b.open("https://www.linkedin.com/cws/share?url="+encodeURIComponent(a.buttons.delicious.url!==""?a.buttons.delicious.url:a.url)+"&token=&isFramed=true","linkedin","toolbar=no,width=550,height=550")},pinterest:function(a){b.open("http://pinterest.com/pin/create/button/?url="+encodeURIComponent(a.buttons.pinterest.url!==""?a.buttons.pinterest.url:a.url)+"&media="+encodeURIComponent(a.buttons.pinterest.media)+"&description="+a.buttons.pinterest.description,"pinterest","toolbar=no,width=700,height=300")}};l.prototype.init=function(){var b=this;if(this.options.urlCurl!==""){h.googlePlus=this.options.urlCurl+"?url={url}&type=googlePlus";h.stumbleupon=this.options.urlCurl+"?url={url}&type=stumbleupon";h.pinterest=this.options.urlCurl+"?url={url}&type=pinterest"}a(this.element).addClass(this.options.className);if(typeof a(this.element).data("title")!=="undefined"){this.options.title=a(this.element).attr("data-title")}if(typeof a(this.element).data("url")!=="undefined"){this.options.url=a(this.element).data("url")}if(typeof a(this.element).data("text")!=="undefined"){this.options.text=a(this.element).data("text")}a.each(this.options.share,function(a,c){if(c===true){b.options.shareTotal++}});if(b.options.enableCounter===true){a.each(this.options.share,function(a,c){if(c===true){try{b.getSocialJson(a)}catch(d){}}})}else if(b.options.template!==""){this.options.render(this,this.options)}else{this.loadButtons()}a(this.element).hover(function(){if(a(this).find(".buttons").length===0&&b.options.enableHover===true){b.loadButtons()}b.options.hover(b,b.options)},function(){b.options.hide(b,b.options)});a(this.element).click(function(){b.options.click(b,b.options);return false})};l.prototype.loadButtons=function(){var b=this;a(this.element).append('<div class="buttons"></div>');a.each(b.options.share,function(a,c){if(c==true){i[a](b);if(b.options.enableTracking===true){j[a]()}}})};l.prototype.getSocialJson=function(b){var c=this,d=0,e=h[b].replace("{url}",encodeURIComponent(this.options.url));if(this.options.buttons[b].urlCount===true&&this.options.buttons[b].url!==""){e=h[b].replace("{url}",this.options.buttons[b].url)}if(e!=""&&c.options.urlCurl!==""){a.getJSON(e,function(a){if(typeof a.count!=="undefined"){var e=a.count+"";e=e.replace("Â ","");d+=parseInt(e,10)}else if(typeof a.likes!=="undefined"){d+=parseInt(a.likes,10)}else if(typeof a.shares!=="undefined"){d+=parseInt(a.shares,10)}else if(typeof a[0]!=="undefined"){d+=parseInt(a[0].total_posts,10)}else if(typeof a[0]!=="undefined"){}c.options.count[b]=d;c.options.total+=d;c.renderer();c.rendererPerso()}).error(function(){c.options.count[b]=0;c.rendererPerso()})}else{c.renderer();c.options.count[b]=0;c.rendererPerso()}};l.prototype.rendererPerso=function(){var a=0;for(e in this.options.count){a++}if(a===this.options.shareTotal){this.options.render(this,this.options)}};l.prototype.renderer=function(){var b=this.options.total,c=this.options.template;if(this.options.shorterTotal===true){b=this.shorterTotal(b)}if(c!==""){c=c.replace("{total}",b);a(this.element).html(c)}else{a(this.element).html('<div class="box"><a class="count" href="#">'+b+"</a>"+(this.options.title!==""?'<a class="share" href="#">'+this.options.title+"</a>":"")+"</div>")}};l.prototype.shorterTotal=function(a){if(a>=1e6){a=(a/1e6).toFixed(2)+"M"}else if(a>=1e3){a=(a/1e3).toFixed(1)+"k"}return a};l.prototype.openPopup=function(a){k[a](this.options);if(this.options.enableTracking===true){var b={googlePlus:{site:"Google",action:"+1"},facebook:{site:"facebook",action:"like"},twitter:{site:"twitter",action:"tweet"},digg:{site:"digg",action:"add"},delicious:{site:"delicious",action:"add"},stumbleupon:{site:"stumbleupon",action:"add"},linkedin:{site:"linkedin",action:"share"},pinterest:{site:"pinterest",action:"pin"}};_gaq.push(["_trackSocial",b[a].site,b[a].action])}};l.prototype.simulateClick=function(){var b=a(this.element).html();a(this.element).html(b.replace(this.options.total,this.options.total+1))};l.prototype.update=function(a,b){if(a!==""){this.options.url=a}if(b!==""){this.options.text=b}};a.fn[f]=function(b){var c=arguments;if(b===d||typeof b==="object"){return this.each(function(){if(!a.data(this,"plugin_"+f)){a.data(this,"plugin_"+f,new l(this,b))}})}else if(typeof b==="string"&&b[0]!=="_"&&b!=="init"){return this.each(function(){var d=a.data(this,"plugin_"+f);if(d instanceof l&&typeof d[b]==="function"){d[b].apply(d,Array.prototype.slice.call(c,1))}})}}})(jQuery,window,document)